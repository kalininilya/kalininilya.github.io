<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>WOOO</title>
  <link rel="stylesheet" href="style.css" media="screen" title="no title">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
</head>

<body>
  <div class="city">
  </div>
  <div class="temp">
  </div>
  <div class="descr">
  </div>
  <script type="text/javascript">
    function getTime() {
      var minutes = 1000 * 60;
      var hours = minutes * 60;
      var d = new Date();
      var t = d.getTime();

      return Math.round(t / hours);
    }

    function getCity() {
      $.getJSON('https://ipinfo.io', function(data) {
        if (data.city === undefined){
          alert("error: unknown city");
        }else{
        getWeather(data.city);
      }
      });
    };

    function getWeather(city) {
      $.ajax({
        type: "GET",
        dataType: "jsonp",
        url: "http://api.openweathermap.org/data/2.5/weather?q=" + city + "&APPID=24343a93c8b5abb03ec99a77df454b11&units=metric",
        success: function(data) {
          showWeather(data.main.temp, data.weather[0].description, city);
        }
      });
    }

    function showWeather(temp, descr, city) {
      $(".city").append("City: " + city);
      $(".descr").append(descr);
      $(".temp").append("Temperature: " + temp + " C");
    };
    $(document).ready(function() {
          getCity();
        });
  </script>

</body>

</html>
